"use strict";window.onload=function(){document.body.classList.add("loaded_hiding"),window.setTimeout(function(){document.body.classList.add("loaded"),document.body.classList.remove("loaded_hiding")},500)};const arrSuit=["./images/elem1.PNG","./images/elem2.PNG","./images/elem3.PNG","./images/elem4.PNG","./images/elem5.PNG","./images/elem6.PNG","./images/elem7.PNG","./images/elem8.PNG"],btn=document.getElementById("start"),tern=document.querySelectorAll(".tern"),allside=document.querySelectorAll(".allside"),blockWin=document.querySelector(".you-winn__inner");let currentNum=0,isStarted=!1,winnerResult=0;const winningLightning=()=>{var e=document.querySelector(".automat__items");const n=document.getElementById("canvas"),c=n.getContext("2d"),r=2*Math.PI;let s=n.width=e.clientWidth,m=n.height=e.clientHeight,d=[],u;const y=2,h=11,g=400;let f=0;class t{constructor(e,t){this.x=e||Math.random()*s,this.y=t||Math.random()*m}draw(e,t){this.x=e||this.x,this.y=t||this.y,c.lineWidth=1.5,c.fillStyle="transparent",c.strokeStyle="transparent",c.beginPath(),c.arc(this.x,this.y,6,0,r),c.closePath(),c.fill(),c.beginPath(),c.arc(this.x,this.y,32,0,r),c.closePath(),c.stroke()}}function b(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-t.y,2))}n.style.background="transparent";for(let e=0;e<5;e++)d.push(new t);!function e(t){t=f,u=requestAnimationFrame(e),c.clearRect(0,0,s,m);for(let s=0;s<d.length;s++)for(let r=s+1;r<d.length;r++){var a=b(d[s],d[r]),i=a/g;if(!(i>Math.random())){var i=255*i,o=a/y;let t=d[s].x,n=d[s].y;c.lineWidth=5.5,c.strokeStyle=`rgb(255, 255, ${i})`,c.filter="drop-shadow(14px 12px 24px cyan) blur(1.7px)",c.beginPath(),c.moveTo(d[s].x,d[s].y);for(let e=o;1<e;e--){var l=b(d[s],{x:t,y:n}),l=Math.sin(l/a*Math.PI)*h;t+=(d[r].x-t)/e+Math.random()*l*2-l,n+=(d[r].y-n)/e+Math.random()*l*2-l,c.lineTo(t,n)}c.stroke()}}d.map((e,t)=>{0==t?e.draw(257,227):1===t?e.draw(5,229):2===t?e.draw(257,20):3===t?e.draw(5,25):4===t&&e.draw(155,140),f++}),1500<t&&(cancelAnimationFrame(u),n.style.zIndex=3)}()},elComparison=t=>{const n=document.querySelector(".numberOfAttempts");var e=document.querySelectorAll(".automat__item>.tern>.front>img");let r=0;return e.forEach(e=>{t[0].src===t[1].src&&t[1].src===t[2].src&&(e.classList.add("active"),setTimeout(()=>{winningLightning()},500),setTimeout(()=>{blockWin.style.display="flex",n.style.display="none"},1300),r=1)}),1===r?winnerResult=1:null},start=()=>{if(!isStarted){isStarted=!0,btn.style.animation=!1,btn.style.cursor="not-allowed",btn.style.disabled=!0;const i=document.querySelectorAll(".center__item>.tern>.front>img");for(let e=0;e<18;e++){var t=Math.floor(7*Math.random());const n=allside[e].querySelector("img");2!==currentNum?n.src=arrSuit[t]:setTimeout(()=>{n.closest(".front")&&setTimeout(()=>{n.src=arrSuit[arrSuit.length-1]},1900)})}return currentNum%2==0?setTimeout(()=>{for(let e=0;e<9;e++){var t=tern[e].querySelector("img");t.closest(".active")&&t.classList.remove("active"),tern[e].style.transform="rotateX(-11500deg)"}},0):currentNum%2!=0&&setTimeout(()=>{for(let e=0;e<9;e++){var t=tern[e].querySelector("img");t.closest(".active")&&t.classList.remove("active"),tern[e].style.transform="rotateX(0deg)"}},0),tern[tern.length-1].addEventListener("transitionend",()=>{var e=document.querySelectorAll(".numberOfAttempts__sum");const t=document.querySelector("#wrap-btn"),r=document.querySelector(".bg__chinese-small"),n=document.querySelector(".you-winn"),s=document.querySelector(".take-your-bonus");e.forEach(e=>{currentNum!=e.dataset.num?e.classList.add("op-none"):e.classList.remove("op-none")}),3===currentNum?btn.style.animation=!1:btn.style.animation="flicker .2s infinite";e=(t,n,e)=>{setTimeout(()=>{var e=r.cloneNode();blockWin.append(e),e.style.top=""+t,e.style.left=""+n,e.classList.add("anim-chinese-small-item")},e)};if(elComparison(i),1===winnerResult){const a=r.cloneNode();blockWin.append(a),setTimeout(()=>{r.classList.add("anim-chinese-small-item"),a.style.top="95%",a.classList.add("anim-chinese-small-item"),n.classList.add("pulse")},0),e("25%","10%",700),e("15%","20%",800),e("28%","30%",1200),e("75%","40%",2500),e("65%","50%",2700),e("95%","60%",2900),e("80%","70%",3200),e("60%","55%",3500),e("40%","45%",4700),e("30%","35%",5900),e("20%","25%",5100),e("10%","15%",6300),e("15%","25%",7300),e("-15%","10%",600),e("-18%","20%",900),e("-25%","30%",1300),e("-28%","40%",1600),e("-15%","50%",21800),e("-10%","60%",3100),e("-13%","70%",3500),e("-33%","80%",4800),e("-43%","65%",5e3),e("-23%","35%",4200),e("-19%","15%",5500),e("-3%","5%",6700),e("0%","13%",7700),t.style.zIndex=-1,s.style.zIndex=99,r.remove()}isStarted=!1,btn.style.cursor="pointer",btn.style.disabled=!1}),++currentNum}};btn.addEventListener("click",()=>{start()});